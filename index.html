<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alexandra's Schedule (Sync Dec 13)</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --text-main: #1a1a1a;

            /* Alexandra */
            --my-bg: #ffffff;
            --my-accent: #00897b;

            /* Away */
            --away-bg: #e0e0e0;
            --away-text: #757575;

            /* Actions */
            --act-pick: #00897b;
            --act-drop: #455a64;
            --act-receive: #689f38;

            /* TBD/Warning */
            --warning-bg: #fff3e0;
            --warning-text: #ef6c00;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 40px 10px;
            color: var(--text-main);
        }

        .container { max-width: 950px; margin: 0 auto; }

        header { text-align: center; margin-bottom: 40px; }
        h1 { margin: 0; color: #37474f; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; font-size: 1.8rem; }
        .sub { color: #546e7a; margin-top: 8px; font-weight: 600; font-size: 0.9rem; }
        .badge {
            display: inline-block; background: #00897b; color: #fff;
            padding: 4px 8px; border-radius: 4px; font-size: 0.7rem;
            text-transform: uppercase; margin-top: 5px; letter-spacing: 0.5px;
        }

        /* LEGEND */
        .legend { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .l-item { display: flex; align-items: center; gap: 6px; font-size: 11px; font-weight: 700; text-transform: uppercase; color: #555; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }

        /* CALENDAR */
        .month { background: white; border-radius: 8px; overflow: hidden; margin-bottom: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; }
        .m-head { background: #37474f; color: white; padding: 15px; text-align: center; font-weight: 800; font-size: 1.2rem; letter-spacing: 1px; }

        .d-head { display: grid; grid-template-columns: repeat(7, 1fr); background: #eceff1; padding: 10px 0; border-bottom: 1px solid #cfd8dc; }
        .d-name { text-align: center; font-size: 0.75rem; font-weight: 800; color: #607d8b; }

        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: #cfd8dc; }

        .day {
            background: white;
            min-height: 160px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* DAY STATES */
        .is-me { background-color: white; }
        .is-me .num { color: var(--my-accent); font-weight: 900; font-size: 1.2rem; }
        .is-me::before { content: ""; display: block; position: absolute; top:0; left:0; right:0; height: 5px; background: var(--my-accent); }

        .is-away { background-color: #f5f5f5; }
        .is-away .num { color: #bdbdbd; }
        .is-away .action { opacity: 0.7; }

        /* ACTIONS */
        .action {
            margin-top: 5px;
            padding: 8px;
            border-radius: 4px;
            color: white;
            font-size: 0.75rem;
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .a-pick { background-color: var(--act-pick); border-left: 4px solid #004d40; }
        .a-drop { background-color: var(--act-drop); border-left: 4px solid #263238; }
        .a-receive { background-color: var(--act-receive); border-left: 4px solid #33691e; }
        .a-tbd { background-color: var(--warning-bg); color: var(--warning-text); border-left: 4px solid #ef6c00; }

        .a-title { font-weight: 900; text-transform: uppercase; margin-bottom: 3px; font-size: 0.7rem; letter-spacing: 0.5px; }
        .a-time { font-weight: 700; font-size: 0.9rem; }
        .a-loc { font-style: italic; opacity: 0.9; font-size: 0.7rem; margin-top: 2px; }

        .note {
            margin-top: auto;
            text-align: right;
            font-size: 0.65rem;
            font-weight: 800;
            color: #d32f2f;
            padding-top: 6px;
            text-transform: uppercase;
        }

        @media print {
            body { background: white; padding: 0; }
            .month { break-inside: avoid; border: 1px solid #ccc; }
            .is-away { background-color: #eee !important; -webkit-print-color-adjust: exact; }
            .a-pick { background-color: #00897b !important; -webkit-print-color-adjust: exact; }
            .a-drop { background-color: #455a64 !important; -webkit-print-color-adjust: exact; }
            .a-tbd { background-color: #ffe0b2 !important; color: #e65100 !important; -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Alexandra's Schedule</h1>
        <div class="badge">Anchored to Dec 12, 2025 (Mom's Weekend)</div>
        <div class="sub">Dec 2025 – Dec 2026 • Mother's Day & Holidays Included</div>
    </header>

    <div class="legend">
        <div class="l-item"><div class="dot" style="background:var(--my-accent)"></div> With Me</div>
        <div class="l-item"><div class="dot" style="background:#bdbdbd"></div> Kids Away</div>
        <div class="l-item"><div class="dot" style="background:var(--act-pick)"></div> Pick Up</div>
        <div class="l-item"><div class="dot" style="background:var(--act-receive)"></div> He Drops Off</div>
        <div class="l-item"><div class="dot" style="background:var(--act-drop)"></div> You Drop Off</div>
        <div class="l-item"><div class="dot" style="background:#ffcc80"></div> TBD Time</div>
    </div>

    <div id="calendar-root"></div>
</div>

<script>
    // --- 1. SETTINGS ---
    const SCHOOL_START_25 = new Date(2025, 7, 11);
    const SCHOOL_END_26 = new Date(2026, 4, 28);
    const SUMMER_START_26 = new Date(2026, 4, 29);
    const SUMMER_END_26 = new Date(2026, 6, 24);
    const SCHOOL_START_26 = new Date(2026, 7, 10);

    // ANCHOR: Dec 12, 2025 = Mom's Weekend (Per user confirmation)
    const ANCHOR_DATE = new Date(2025, 11, 12, 12, 0, 0);

    const NO_SCHOOL = [
        '2025-12-22','2025-12-23','2025-12-24','2025-12-25','2025-12-26',
        '2025-12-29','2025-12-30','2025-12-31','2026-01-01','2026-01-02','2026-01-05',
        '2026-01-19','2026-02-16','2026-04-03','2026-04-06','2026-04-07','2026-04-08',
        '2026-04-09','2026-04-10','2026-05-25','2026-05-29'
    ];

    const NO_SCHOOL_FALL_26 = [
        '2026-09-07', '2026-11-11',
        '2026-11-23', '2026-11-24', '2026-11-25', '2026-11-26', '2026-11-27',
        '2026-12-21', '2026-12-22', '2026-12-23', '2026-12-24', '2026-12-25',
        '2026-12-28', '2026-12-29', '2026-12-30', '2026-12-31'
    ];

    const MIN_DAYS = [
        '2025-11-10', '2025-11-11', '2025-11-13', '2025-11-14',
        '2026-03-09', '2026-03-10', '2026-03-12', '2026-03-13',
        '2026-05-28'
    ];

    // --- 2. HELPERS ---
    function isSchool(date) {
        if (date < SCHOOL_START_25) return false;
        if (date > SCHOOL_END_26 && date < SCHOOL_START_26) return false;
        if (date.getDay() === 0 || date.getDay() === 6) return false;
        const iso = date.toISOString().split('T')[0];
        if (NO_SCHOOL.includes(iso)) return false;
        if (NO_SCHOOL_FALL_26.includes(iso)) return false;
        return true;
    }

    function isMomsWeekend(date) {
        let d = new Date(date);
        d.setHours(12,0,0,0);
        let dow = d.getDay();
        if (dow === 6) d.setDate(d.getDate() - 1);
        else if (dow === 0) d.setDate(d.getDate() - 2);
        else if (dow !== 5) d.setDate(d.getDate() - ((dow + 2) % 7));

        const diffTime = d - ANCHOR_DATE;
        const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));
        const diffFortnights = Math.floor(diffDays / 14);

        return (diffFortnights % 2 === 0);
    }

    function getPickTime(date) {
        let isMin = (date.getDay() === 3);
        const iso = date.toISOString().split('T')[0];
        if (MIN_DAYS.includes(iso)) isMin = true;
        if (isMin) return "1:10 (Alfie) / 1:25 (Basil)";
        return "2:15 (Alfie) / 2:50 (Basil)";
    }

    // --- 3. LOGIC ENGINE ---
    function getDayData(date) {
        const y = date.getFullYear();
        const m = date.getMonth();
        const d = date.getDate();
        const day = date.getDay();

        let status = 'away';
        let events = [];
        let note = '';

        // == MOTHER'S DAY (May 10) ==
        if (m === 4 && d === 10) { // May 10, 2026 (Sun)
            status = 'me';
            events.push({type:'receive', title:'HE DROPS OFF', time:'9:00 AM', loc:'Your Home (Curbside)'});
            note = "Mother's Day";
            return {status, events, note};
        }
        // Return from Mother's Day (May 11 - Mon)
        if (m === 4 && d === 11) {
            // Monday is typically Dad's (unless holiday).
            // But if it was Mom's weekend anyway, she keeps them.
            // Let's check if May 8 (Fri) was Mom's weekend.
            // Based on Anchor (Dec 12), May 1 (Fri) is Mom. May 8 (Fri) is Dad.
            // So May 10 is Dad's Weekend. Mom gets them Sun 9am.
            // Mom must drop off Monday morning.
            status = 'me';
            if(isSchool(date)) events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
            else events.push({type:'drop', title:'YOU DROP OFF', time:'TBD', loc:'His House (Curbside)'});
            note = "Return from Mother's Day";
            return {status, events, note};
        }

        // == BIRTHDAY OVERRIDES ==
        if (m === 9 && d === 2) {
             status='me';
             if (isSchool(date)) {
                 events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                 events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'});
             } else {
                 events.push({type:'receive', title:'HE DROPS OFF', time:'9:00 AM', loc:'Your Home (Curbside)'});
             }
             note='Your Birthday';
             return {status, events, note};
        }
        if (m === 9 && d === 3) {
            if (isMomsWeekend(date)) {
                status='me'; note='My Weekend (Cont.)';
                return {status, events, note};
            } else {
                status='me';
                if(isSchool(date)) events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                else events.push({type:'drop', title:'YOU DROP OFF', time:'9:00 AM', loc:'His House (Curbside)'});
                note='Return from Birthday';
                return {status, events, note};
            }
        }
        if (m === 11 && d === 31) return {status:'away', events:[], note:"His Birthday (Already with Dad)"};

        // == HOLIDAYS ==
        if (y===2025 && m===11) {
            if(d===18) { status='me'; events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'}); note='Winter Break Starts'; return {status, events, note}; }
            if(d===19) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'}); events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'}); note='Winter Break Custody'; return {status, events, note}; }
            if(d>19 && d<22) return {status:'me', events:[], note:'Winter Break'};
            if(d===22) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'11:00 AM', loc:"His House (Curbside)"}); note='Exchange'; return {status, events, note}; }
            if(d===25) { status='me'; events.push({type:'receive', title:'HE DROPS OFF', time:'11:00 AM', loc:"Your Home (Curbside)"}); note='Christmas'; return {status, events, note}; }
            if(d>25 && d<29) return {status:'me', events:[], note:'Winter Break'};
            if(d===29) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'11:00 AM', loc:"His House (Curbside)"}); note='Exchange'; return {status, events, note}; }
            if(d<18) { /* Fall through */ } else return {status:'away', events:[], note:''};
        }

        if (y===2026 && m===0 && d<=5) {
            if(d===1) return {status:'away', events:[], note:''};
            if(d===2) { status='me'; events.push({type:'receive', title:'HE DROPS OFF', time:'11:00 AM', loc:"Your Home (Curbside)"}); note='Exchange'; return {status, events, note}; }
            if(d>2 && d<5) return {status:'me', events:[], note:'Winter Break'};
            if(d===5) {
                status='me';
                // TBD / 2:15 logic
                events.push({type:'tbd', title:'YOU DROP OFF', time: "TBD / Agreed Time", loc:"His House (Curbside)"});
                note='PD Day (No School)';
                return {status, events, note};
            }
        }

        if (y===2026 && m===3) {
            if(d===2) { status='me'; events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'}); note='Spring Break Starts'; return {status, events, note}; }
            if(d===3) return {status:'me', events:[], note:'Cesar Chavez (No School)'};
            if(d>3 && d<8) return {status:'me', events:[], note:'Spring Break'};
            if(d===8) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'12:00 PM', loc:"His House (Curbside)"}); note='Mid-Break Exchange'; return {status, events, note}; }
            if(d>8 && d<=12) return {status:'away', events:[], note:''};
        }

        if (date >= SUMMER_START_26 && date <= SUMMER_END_26) {
             const diff = Math.floor((date - SUMMER_START_26) / (1000 * 60 * 60 * 24));
             const weekNum = Math.floor(diff / 7) + 1;
             const nextWeekNum = weekNum + 1;
             const isMyCurrentWeek = [1,3,5,7].includes(weekNum);
             const isMyNextWeek = [1,3,5,7].includes(nextWeekNum);

             if (m===5 && d===21) return {status:'away', events:[], note:"Father's Day"};

             if (day === 5 && weekNum <= 8) {
                 if (isMyCurrentWeek && !isMyNextWeek) {
                     status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'4:00 PM', loc:"Camp or His House (Curbside)"}); note=`End Summer Wk ${weekNum}`; return {status, events, note};
                 } else if (!isMyCurrentWeek && isMyNextWeek) {
                     status='me'; events.push({type:'receive', title:'HE DROPS OFF', time:'4:00 PM', loc:"Camp or Your Home (Curbside)"}); note=`Start Summer Wk ${nextWeekNum}`; return {status, events, note};
                 }
             }
             if (isMyCurrentWeek) return {status:'me', events:[], note:`Summer Week ${weekNum}`};
             return {status:'away', events:[], note:''};
        }

        if (y===2026 && m===10) {
            if(d===20) { status='me'; events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'}); note='TG Break Starts'; return {status, events, note}; }
            if(d===21 || d===22) return {status:'me', events:[], note:'Thanksgiving Break'};
            if(d>=23 && d<=24) return {status:'me', events:[], note:'Thanksgiving Break'};
            if(d===25) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'12:00 PM', loc:"His House (Curbside)"}); note='Mid-Break Exchange'; return {status, events, note}; }
            if(d>=26 && d<=27) return {status:'away', events:[], note:''};
        }

        if (y===2026 && m===11) {
            if(d===18) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'}); events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'}); note='Winter Break Starts'; return {status, events, note}; }
            if(d>18 && d<26) { if(d===25) return {status:'me', events:[], note:'Christmas'}; return {status:'me', events:[], note:'Winter Break'}; }
            if(d===26) { status='me'; events.push({type:'drop', title:'YOU DROP OFF', time:'11:00 AM', loc:"His House (Curbside)"}); note='Mid-Break Exchange'; return {status, events, note}; }
            if(d>26) return {status:'away', events:[], note:''};
        }

        // == REGULAR SCHEDULE ==
        let isMomsWknd = isMomsWeekend(date);

        // Mondays
        if (day === 1) {
            let prevDay = new Date(date); prevDay.setDate(d-1);
            if (isMomsWeekend(prevDay)) {
                if (!isSchool(date)) {
                    if (y===2026 && m===7 && d===10) { /* School Start */ }
                    else return {status:'me', events:[], note:'Holiday Extension (Yours)'};
                }
                status='me';
                if (isSchool(date)) events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                else events.push({type:'drop', title:'YOU DROP OFF', time:'8:30 AM', loc:"His House (Curbside)"});
                return {status, events, note};
            }
        }

        // Tuesdays
        if (day === 2) {
             let prevDay = new Date(date); prevDay.setDate(d-1);
             if (!isSchool(prevDay) && isMomsWeekend(prevDay)) {
                 status='me';
                 if (isSchool(date)) {
                     events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                     note='Return from Holiday';
                 } else {
                     events.push({type:'tbd', title:'YOU DROP OFF', time:"TBD / Agreed Time", loc:"His House (Curbside)"});
                     note='Return from Holiday (No School)';
                 }
                 return {status, events, note};
             }
        }

        if (day === 4) {
            status = 'me';
            if (isSchool(date)) events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'});
            else note='Thursday Overnight';
            return {status, events, note};
        }

        if (day === 5) {
            if (y===2026 && m===4 && d===29) return {status:'me', events:[], note:'Continuous Care (Summer W1 Starts)'};
            if (isMomsWknd) {
                status = 'me';
                if (isSchool(date)) {
                    events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                    events.push({type:'pick', title:'YOU PICK UP', time:getPickTime(date), loc:'School'});
                    note='Weekend Start';
                } else {
                    note='My Weekend (No School)';
                }
                return {status, events, note};
            } else {
                status = 'away';
                if (isSchool(date)) {
                    events.push({type:'drop', title:'YOU DROP OFF', time:'8:20 AM', loc:'School'});
                    note='End of your time';
                } else {
                    events.push({type:'tbd', title:'YOU DROP OFF', time: "TBD / Agreed Time", loc:"His House (Curbside)"});
                    note='Exchange (No School)';
                }
                return {status, events, note};
            }
        }

        if (day === 6 || day === 0) {
            if (isMomsWeekend(date)) return {status:'me', events:[], note:'My Weekend'};
            return {status:'away', events:[], note:''};
        }

        return {status, events, note};
    }

    const root = document.getElementById('calendar-root');
    const months = [
        { y: 2025, m: 11, name: 'December 2025' },
        { y: 2026, m: 0, name: 'January 2026' },
        { y: 2026, m: 1, name: 'February 2026' },
        { y: 2026, m: 2, name: 'March 2026' },
        { y: 2026, m: 3, name: 'April 2026' },
        { y: 2026, m: 4, name: 'May 2026' },
        { y: 2026, m: 5, name: 'June 2026' },
        { y: 2026, m: 6, name: 'July 2026' },
        { y: 2026, m: 7, name: 'August 2026' },
        { y: 2026, m: 8, name: 'September 2026' },
        { y: 2026, m: 9, name: 'October 2026' },
        { y: 2026, m: 10, name: 'November 2026' },
        { y: 2026, m: 11, name: 'December 2026' }
    ];

    const dNames = ['SUN','MON','TUE','WED','THU','FRI','SAT'];

    months.forEach(cfg => {
        const mDiv = document.createElement('div');
        mDiv.className = 'month';
        mDiv.innerHTML = `<div class="m-head">${cfg.name}</div>`;
        const dh = document.createElement('div');
        dh.className = 'd-head';
        dNames.forEach(n => dh.innerHTML += `<div class="d-name">${n}</div>`);
        mDiv.appendChild(dh);
        const grid = document.createElement('div');
        grid.className = 'grid';
        const daysInMonth = new Date(cfg.y, cfg.m + 1, 0).getDate();
        const startDay = new Date(cfg.y, cfg.m, 1).getDay();
        for(let i=0; i<startDay; i++) grid.innerHTML += `<div class="day is-away"></div>`;
        for(let d=1; d<=daysInMonth; d++) {
            const date = new Date(cfg.y, cfg.m, d);
            const data = getDayData(date);
            let html = `<div class="num">${d}</div>`;
            data.events.forEach(e => {
                let cls = 'a-pick';
                if(e.type==='drop') cls = 'a-drop';
                if(e.type==='receive') cls = 'a-receive';
                if(e.type==='tbd') cls = 'a-tbd';
                html += `<div class="action ${cls}"><span class="a-title">${e.title}</span><span class="a-time">${e.time}</span><span class="a-loc">@ ${e.loc}</span></div>`;
            });
            if(data.note) html += `<div class="note">${data.note}</div>`;
            const cell = document.createElement('div');
            cell.className = `day is-${data.status}`;
            cell.innerHTML = html;
            grid.appendChild(cell);
        }
        mDiv.appendChild(grid);
        root.appendChild(mDiv);
    });
</script>
</body>
</html>
